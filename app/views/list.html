<div class="jumbotron" ng-if="!selectedUser">
  <h1>{{username}}, WHO DO YOU WANT TO VISIT?</h1>
  <input autofocus class="form-control search-person" type="text" ng-model="selectedUser" placeholder=""
         uib-typeahead="user as user.name for user in users| filter:{name:$viewValue}"
         typeahead-popup-template-url="customPopupTemplate.html"
         typeahead-on-select="selectUser($item, $model, $label)">
</div>

<div class="jumbotron" ng-if="selectedUser">
  <h1 ng-if="appState == 'available'">YAY! <br/>{{selectedUser.name}} IS HERE. YOU CAN POP UP NOW.</h1>

  <h1 ng-if="appState == 'busy'">DON'T BOTHER LOOKS LIKE {{selectedUser.name}} IS POOPING.</h1>
  <button ng-if="appState == 'available'" class="message-person available" ng-click="sendMessage(false, 'I`m coming')">
    I'm on my way!
  </button>
  <button ng-if="appState == 'busy'" class="message-person busy" ng-click="notifyMe(false)">Notify when available
  </button>

  <div class="user-details">
    <a class="user-image" ng-href="{{selectedUser.url}}" target="_blank" ng-style="{backgroundImage: 'url(' + getLargeImage(selectedUser.photo_url) + ')'}"></a>
    <div class="rate {{badge}}" ng-init="rate()"></div>
    <ul class="user-texts">
      <li><a ng-href="{{selectedUser.url}}" target="_blank" >{{selectedUser.name}}</a></li>
      <li ng-show="selectedUser.title"><a>{{selectedUser.title}}</a></li>
      <li ng-show="selectedUser.location"><a>{{selectedUser.location}}</a></li>
      <li ng-show="selectedUser.phone"><a>{{selectedUser.phone}}</a></li>
      <li ng-show="selectedUser.email"><a target="_blank" ng-href="mailto:{{selectedUser.email}}">{{selectedUser.email}}</a></li>
    </ul>
  </div>
</div>

<footer>
      <span ng-click="clearSelectedUser()">
        MISHA.M
      </span>
  <a ng-click="toggleBusy(me.status!='busy')" class="{{me.status}}">
    <i class="fa fa-{{me.status=='busy' ? 'ban' : 'check-circle-o'}}"></i>
  </a>
</footer>


<script type="text/ng-template" id="customPopupTemplate.html">
  <div class="custom-popup-wrapper"
       ng-style="{top: position().top+'px', left: position().left+'px'}"
       style="display: block;"
       ng-show="isOpen() && !moveInProgress"
       aria-hidden="{{!isOpen()}}"
  ><p class="message">Who do you want to visit?</p>

    <ul class="dropdown-menu" role="listbox">
      <li ng-repeat="match in matches track by $index" ng-class="{active: isActive($index) }"
          ng-mouseenter="selectActive($index)" ng-click="selectMatch($index); selectUser(match);" role="option"
          id="{{::match.id}}">
        <div uib-typeahead-match index="$index" match="match" query="query" template-url="templateUrl"></div>
      </li>
    </ul>
  </div>
</script>
