{"version":3,"sources":["../scripts.babel/popup.js"],"names":[],"mappings":"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","file":"popup.js","sourcesContent":["'use strict';\n\nangular\n  .module('misha', [\n    'ui.bootstrap.typeahead',\n    'ngAnimate',\n    'ngCookies',\n    'ngResource',\n    'ngRoute',\n    'ngSanitize'\n  ])\n  .config(['$routeProvider', function ($routeProvider) {\n    $routeProvider\n      .when('/user', {\n        templateUrl: 'views/main.html',\n        controller: 'MainCtrl',\n        controllerAs: 'main'\n      })\n      .when('/', {\n        controller:   'ListCtrl',\n        controllerAs: 'list',\n        templateUrl:  'views/list.html',\n      }).otherwise({\n        redirectTo: '/'\n      });\n  }])\n\n  .controller('UserCtrl', ['$scope', '$resource', function ($scope, $resource) {\n\n  }])\n\n\n  .controller('ListCtrl', ['$scope', '$resource', '$timeout', '$interval', function ($scope, $resource, $timeout, $interval) {\n    var bg = chrome.extension.getBackgroundPage();\n\n    var api = bg.api;\n\n    var User = $resource(api + '/user/:userId', { userId: '@id' }, {\n      'update': { method:'PUT' }\n    });\n    var Pending = $resource(api + '/pending/:userId', { userId: '@id' });\n\n    $scope.username = \"Hi\";\n    $scope.users = [];\n    $scope.started = localStorage['start'];\n\n    function refreshUsers() {\n      $scope.me = bg && bg.me;\n      $scope.username = bg && bg.me && bg.me.name && bg.me.name.split(' ')[0];\n      $scope.users = bg.users;\n    }\n\n    refreshUsers();\n    $interval(refreshUsers, bg.seenInterval);\n\n    $scope.toggleBusy = function() {\n      if (!$scope.me) return;\n      $scope.me.busy = !$scope.me.busy;\n      if ($scope.me.busy) {\n        chrome.browserAction.setIcon({'path': api + '/images/icons/red.png'})\n      } else {\n        chrome.browserAction.setIcon({'path': api + '/images/icons/' + ($scope.me.status=='available' ? 'green' : 'yellow') + '.png'})\n      }\n\n      User.update({userId: $scope.me.id}, {busy: $scope.me.busy});\n    };\n\n    $scope.started = function() {\n      localStorage['started'] = true;\n    }\n\n    $scope.invite = function() {\n      if (!$scope.selectedUser) return;\n      User.save({userId: 'invite'}, {from: $scope.me.email, to: $scope.selectedUser.email, name: $scope.selectedUser.name});\n      $scope.clearSelectedUser();\n    };\n\n    $scope.notifyMe = function(userId) {\n      if (!userId) userId = $scope.selectedUser.id;\n      if (!$scope.me) return;\n\n      var notify = new Pending({\n        user_id: $scope.me.id,\n        waiting_for: userId,\n        message: 'is now available!'\n      });\n      notify.$save(function(data) {\n        if(data && data.$resolved) {\n          $scope.successAndClose();\n        }\n      });\n    };\n\n    $scope.sendMessage = function(userId, message) {\n      if (!userId) userId = $scope.selectedUser.id;\n      if (!$scope.me) return;\n\n      var notify = new Pending({\n        user_id: userId,\n        waiting_for: $scope.me.id,\n        message: message\n      });\n      notify.$save(function(data){\n        if(data && data.$resolved) {\n          $scope.successAndClose();\n        }\n      });\n    }\n\n    $scope.successAndClose = function() {\n      $scope.showSuccess = true;\n      $timeout(function() {\n        window.close();\n      }, 3000);\n    }\n\n    $scope.clearSelectedUser = function() {\n      $scope.selectedUser = '';\n      $scope.appState = '';\n    }\n\n    $scope.selectUser = function(user) {\n      $scope.selectedUser = user;\n      //$scope.appState = isAvailable(user) ? 'available' : 'busy';\n      $scope.appState = getUserAvailability(user);\n      User.get({userId: user.id}, function (res) {\n        $scope.selectedUser = res;\n      });\n    }\n\n    $scope.getLargeImage = function(url) {\n      if (!url) return;\n      return url.replace('thumb_small', 'original');\n    }\n\n    function isAvailable(user) {\n      if (!user || !user.last_seen || !user.hasOwnProperty('last_seen')) return false;\n      if (!user.status || user.status != 'available') return false;\n      if (user.busy && user.busy != 'false') return false;\n      var now = (new Date()).getTime();\n      var lastSeen;\n\n      lastSeen = (new Date(Number(user.last_seen))).getTime();\n\n      return ((now - lastSeen) < (bg.awayDuration));\n    }\n\n    function getUserAvailability(user) {\n      if (!user || !user.last_seen || !user.hasOwnProperty('last_seen') ||\n           user.busy && user.busy != 'false') return 'busy';\n      if (!user.status || user.status == 'away') return 'away'\n\n      var now = (new Date()).getTime();\n      var lastSeen;\n\n      if (!user || !user.last_seen || !user.hasOwnProperty('last_seen')) return false;\n\n      lastSeen = (new Date(Number(user.last_seen))).getTime();\n\n      return ((now - lastSeen) < (bg.awayDuration))? 'available': 'busy';\n    }\n\n    $scope.rate = function() {\n      switch (Math.floor(Math.random() * 3)) {\n        case 0:\n          $scope.badge = 'king';\n          break;\n        case 1:\n          $scope.badge = 'wixer';\n          break;\n        case 2:\n          $scope.badge = 'mega-kaker';\n          break;\n      }\n    }\n\n  }]);\n\n//  \"client_id_prod\": \"1051518271202-64fst397g2iqr3sahpvb8iohofi3t289.apps.googleusercontent.com\",\n"]}